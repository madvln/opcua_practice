# OPC DA (Data access)

## Общая информация

**OPC** (аббр. от англ. Open Platform Communications, ранее англ. OLE for Process Control) – это набор программных технологий, которые предоставляют единый интерфейс для управления различными устройствами и обмена данными.

**OPC** состоит из двух частей: OPC клиента и OPC сервера. ПО OPC сервера через драйверы устройств по полевым шинам опрашивает различные устройства. ПО OPC клиента обычно встроено в SCADA систему и предназначено для получения данных с OPC сервера.

**OPC DA** (Data Access) — наиболее распространённый стандарт. Описывает набор функций обмена данными в реальном времени с ПЛК, РСУ, ЧМИ, ЧПУ и другими устройствами.


## Принцип рвботы OPC DA

**OPC DA** сервер обеспечивает обмен данными (запись и чтение) между клиентской программой (обычно SCADA системой) и конечными устройствами. Данные в OPC представляют собой переменную Тег с некоторыми свойствами. Переменная может быть любого типа, допустимого в OLE: различные целые и вещественные типы, логический тип, строковый, дата, массивом и т. д. Свойства могут быть обязательными, рекомендуемыми и пользовательскими. Обязательными полями являются **значение** переменной, ее **качество** и **временная метка**

Для **чтения данных** из ОРС сервера можно использовать различные режимы:

1. **Синхронный режим**: клиент посылает запрос серверу и ждет от него ответ.
2. **Асинхронный режим**: клиент отправляет запрос и сразу же переходит к выполнению других задач. Сервер после обработки запроса посылает клиенту уведомление и тот забирает предоставленные данные.
3. **Режим подписки**: сервер отсылает клиенту только те теги, которые изменились. Для того, чтобы шум данных не был принят за их изменение, вводится понятие "мертвой зоны", которая слегка превышает максимально возможный размах помехи.
4. **Режим обновления данных**: клиент вызывает одновременное чтение всех активных тегов. Активными называются все теги, кроме обозначенных как "пассивные". Такое деление тегов уменьшает загрузку процессора обновлением данных, принимаемых из физического устройства.

## Недостатки OPC DA

Несмотря на широкое распространение, OPC DA имеет ряд существенных ограничений:

1. **Зависимость от Windows и DCOM**
   -  Работает только в среде Windows
   - Требует сложной настройки DCOM-безопасности
   - Проблемы с межсетевым взаимодействием через брандмауэры

2. **Проблемы безопасности**
   - Уязвимости в DCOM (распределённый COM)
   - Сложность управления правами доступа
   - Отсутствие встроенного шифрования данных

3. **Архитектурные ограничения**
   - Низкая производительность при работе с >10 000 тегов
   - Отсутствие встроенного механизма буферизации данных
   - Нет поддержки истории данных (только текущие значения)

----------